<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claim Requests Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #F8FAFC; /* A very light blue/off-white */
        }
        .card {
            background-color: #FFFFFF;
            border-left: 4px solid #3B82F6; /* A clear, vibrant blue border */
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .btn-dealer {
            background-color: #2563EB; /* A deeper, solid blue */
        }
        .btn-supplier {
            background-color: #1D4ED8; /* An even deeper blue */
        }
        .btn-dealer:hover {
            background-color: #1E40AF;
        }
        .btn-supplier:hover {
            background-color: #1E3A8A;
        }
    </style>
</head>
<body>
    <div class="container mx-auto p-4">
        <header class="text-center my-8">
            <h1 class="text-4xl font-extrabold text-blue-900">Claim Requests Portal</h1>
            <p class="text-lg text-blue-700 mt-2">Manage and track your claim requests efficiently.</p>
        </header>

        <main id="card-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div id="loading" class="col-span-full text-center text-blue-600 text-lg font-medium py-10">
                Loading claims...
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const apiUrl = 'https://script.google.com/macros/s/AKfycbxKHLxhcxparrfNpCcC8jExol17fJjmL-uuMxia_uld7t8AcsMrDUxZkIrRT-GT9d1AJw/exec';
            const cardContainer = document.getElementById('card-container');
            const loadingElement = document.getElementById('loading');

            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    loadingElement.style.display = 'none'; // Hide loading message
                    if (data && data.data && data.data.length > 0) {
                        data.data.forEach(claim => {
                            const cardHtml = createClaimCard(claim);
                            cardContainer.innerHTML += cardHtml;
                        });
                    } else {
                        cardContainer.innerHTML = `<div class="col-span-full text-center text-gray-500 py-10">
                            No claim requests found.
                        </div>`;
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                    loadingElement.style.display = 'none';
                    cardContainer.innerHTML = `<div class="col-span-full text-center text-red-600 py-10">
                        Failed to load data. Please try again later.
                    </div>`;
                });

            function createClaimCard(claim) {
                // Ensure data is available before creating the card
                const dealerName = claim['Dealer Name'] || 'N/A';
                const reqId = claim['REQ-ID'] || 'N/A';
                const product = claim['Product'] || 'N/A';
                const qty = claim['Qty'] !== undefined ? claim['Qty'] : 'N/A';
                const crmName = claim['CRM Name'] || 'N/A';
                const ownerRemark = claim['Owner Remark'] || 'No remark';

                return `
                <div class="card p-6 rounded-lg shadow-md flex flex-col justify-between">
                    <div>
                        <span class="bg-blue-100 text-blue-800 text-sm font-semibold px-2.5 py-0.5 rounded-full">${reqId}</span>
                        <h2 class="text-xl font-bold text-blue-900 mt-2">${dealerName}</h2>
                        <p class="text-gray-700 mt-1">Product: <span class="font-medium">${product}</span></p>
                        <p class="text-gray-700">Quantity: <span class="font-medium">${qty}</span></p>
                        <p class="text-gray-700">CRM: <span class="font-medium">${crmName}</span></p>
                        <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md">
                            <p class="text-sm font-semibold text-blue-800">Owner Remark:</p>
                            <p class="text-sm text-blue-700 italic">${ownerRemark}</p>
                        </div>
                    </div>
                    <div class="flex flex-col sm:flex-row mt-6 space-y-2 sm:space-y-0 sm:space-x-2">
                        <button class="flex-1 btn-dealer text-white py-2 px-4 rounded-md font-semibold text-sm hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Dealer Claim Done
                        </button>
                        <button class="flex-1 btn-supplier text-white py-2 px-4 rounded-md font-semibold text-sm hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Supplier Claim Done
                        </button>
                    </div>
                </div>
                `;
            }
        });
    </script>
</body>
</html>
